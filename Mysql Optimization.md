## Mysql Optimization

数据库性能取决于数据库级别的多个因素，比如表、查询、配置项。这些软件构造导致硬件级别的CPU 或者IO 操作，这使得你必须尽可能地降低 和尽可能地使其高效的运行。假如你在做数据库性能优化，熟悉要学习软件方面的高级规则和指南。当你成为专家时，你会更多的知道内部时如何运行的，然后开始评估CPU周期 和 IO 操作。

典型的用户目标是从他们已经存在的软件和硬件配置中获取更好的性能表现。高级用户查找改善Mysql 软件本性性能优化的机会，或者开发自己的存储引擎和硬件设备去扩展Mysql 生态。

- 优化数据库级别
- 优化硬件级别
- 平衡移植性和性能

#### 在数据库级别的优化

  使数据库应用程序更好的运行是了解它基本设计：

- 表结构是否合理？ 在实践过程中，表字段是否是正确的数据类型，是否每个表是否有更好的列？例如，执行频繁更新的应用程序应尽可能少的表字段，而分析大量数据的应用程序通常有很少字段的表。

- 是否有适合的索引来提高查询效率？

- 是否为每个表选择正确的存储引擎，并且是否利用存储引擎的优势和功能？特别是事务性的存储引擎, 比如Innodb，或者非事务性的存储引擎比如MyISAM 对于性能和伸缩性来熟是非常重要的。

- 每个表是否使用适当的行格式？此选择还是取决于表的存储引擎。特别是，压缩表使用更少的磁盘，和使用更少的磁盘IO来读取和写数据。压缩适用于具有Innodb表所有的类型 和 只读的MyISAM表。

- 应用程序是否使用适当的锁定策略？比如，尽可能的允许共享访问，以便数据库更好地执行并发，并在适当的请求独占访问 以便关键操作成为最高优先级。同样，存储引擎也一样。Innodb存储引擎处理大部分的锁定问题，允许数据库更好的并发和降低试验性的数量。

- 是否正确的使用缓存的所有内存区域？也就是说，足够大的内存使其容纳更多的缓存，但是也不能太大以至于它们会超出物理内存然后导致paging。需要改配置的是Innodb缓存池、MyISAM秘密缓存和Mysql查询缓存。

  ```te
  注意
    Innodb 是默认的存储引擎。实际上，对与比较麻烦的数据库，高级的Innodb性能特性比MyISAM更简单在硬件级别的优化
  ```

#### 在硬件级别的优化

 当数据库变得越来越繁忙，导致数据库程序会到达硬件的限制。为了避免瓶颈，DBA必须评估是否调整应用程序或者重新配置服务器。系统瓶颈主要来源于:

- 磁盘寻址。磁盘需要一定的时间才能查找到数据。对于现在的磁盘而言，平均耗时低于10ms。因此我们大概100次/s寻址。这个时间用新的磁盘会慢慢改善，并且很难正对单表进行优化。优化寻址的方法是使用多个磁盘。
- 磁盘读写。当磁盘位于正确的位置时，会读取或者写入数据。对于现在的磁盘而言，一个磁盘能够提供10-20m/s的吞吐量。这个比搜索寻址更好优化，你可以使用多个磁盘进行并发读取。
- CPU周期。当数据在内存中，我们必须处理然后得到想要的结果。对于大表而言是主要的限制条件，而小表不存在该情况。
- 内存带宽。当CPU处理的数据超过CPU缓存容量是，主内存带宽将成为瓶颈。但是对于大部分操作系统而言，这个是一个不常见的瓶颈。